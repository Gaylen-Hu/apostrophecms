{% extends "layout.html" %}
{% import "filters.html" as filters %}
{% import "@apostrophecms/pager:macros.html" as pager with context %}

{% block main %}
<section class="bp-content">
  <div class="container mx-auto px-4 md:px-6 py-20">
    {# 页面标题 #}
    <div class="text-center mb-16">
      <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-6">
        博客文章
      </h1>
      <div class="w-20 h-1 bg-blue-600 mx-auto"></div>
    </div>

    {# 筛选器 #}
    <div class="mb-12">
      {% render filters.render({ filters: data.piecesFilters, query: data.query, url: data.page._url }) %}
    </div>

    {# 文章列表 #}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      {% for piece in data.pieces %}
        <article class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
          {# 展示图 #}
          {% if piece.featuredImage %}
            <div class="aspect-video overflow-hidden">
              {% area piece, 'featuredImage' %}
            </div>
          {% else %}
            <div class="aspect-video bg-gray-200 flex items-center justify-center">
              <i class="fa-solid fa-image text-gray-400 text-4xl"></i>
            </div>
          {% endif %}
          
          {# 文章内容 #}
          <div class="p-6">
            {# 分类标签 #}
            <div class="mb-3">
              <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium">
                {{ piece.category }}
              </span>
            </div>
            
            {# 文章标题 #}
            <h2 class="text-xl font-bold text-gray-900 mb-3 line-clamp-2">
              <a href="{{ piece._url }}" class="hover:text-blue-600 transition-colors">
                {{ piece.title }}
              </a>
            </h2>
            
            {# 文章摘要 #}
            {% if piece.excerpt %}
              <p class="text-gray-600 mb-4 line-clamp-3">
                {{ piece.excerpt }}
              </p>
            {% endif %}
            
            {# 文章元信息 #}
            <div class="flex items-center justify-between text-sm text-gray-500">
              <div class="flex items-center">
                <i class="fa-solid fa-user mr-1"></i>
                <span>{{ piece.author }}</span>
              </div>
              <div class="flex items-center">
                <i class="fa-solid fa-calendar mr-1"></i>
                <span>{{ piece.publishDate | date('MM/DD') }}</span>
              </div>
            </div>
            
            {# 阅读更多按钮 #}
            <div class="mt-4">
              <a href="{{ piece._url }}" class="inline-flex items-center text-blue-600 hover:text-blue-800 font-medium">
                阅读更多
                <i class="fa-solid fa-arrow-right ml-2 text-sm"></i>
              </a>
            </div>
          </div>
        </article>
      {% endfor %}
    </div>

    {# 分页器 #}
    {% if data.totalPages > 1 %}
      <div class="mt-16">
        {{ pager.render({ page: data.currentPage, total: data.totalPages }, data.url) }}
      </div>
    {% endif %}
  </div>
</section>
{% endblock %}